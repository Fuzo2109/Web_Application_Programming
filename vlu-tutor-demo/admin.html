<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - VLU Tutor System</title>
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/admin-theme.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div style="display: flex; min-height: 100vh; background: #f8fafc;">
    <div class="sidebar">
      <div class="user-info">
        <div class="user-logo"><i class="fas fa-user-cog"></i></div>
        <div class="user-name">Admin</div>
        <div class="user-id">Admin ID: A0001</div>
      </div>
      <div class="sidebar-menu">
        <a href="#dashboard" class="active"><i class="fas fa-chart-bar"></i><span>Dashboard</span></a>
        <a href="#users"><i class="fas fa-users"></i><span>User Management</span></a>
        <a href="#monitor"><i class="fas fa-server"></i><span>System Monitoring</span></a>
        <a href="#logout"><i class="fas fa-sign-out-alt"></i><span>Logout</span></a>
      </div>
    </div>
    <div class="main-content">
      <div class="header-bar" style="background:#fff;box-shadow:0 2px 12px rgba(177,31,36,0.06);padding:0 32px;height:68px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:10;">
        <div class="header-left" style="display:flex;align-items:center;gap:18px;">
          <div class="header-logo" style="width:44px;height:44px;border-radius:12px;background:var(--main-gradient);display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.7rem;font-weight:bold;">
            <i class="fas fa-user-cog"></i>
          </div>
          <span class="header-admin" style="font-size:1.15rem;font-weight:600;color:var(--main-color);">Admin Dashboard</span>
        </div>
        <div class="header-right" style="display:flex;align-items:center;gap:18px;">
          <div class="header-notify" style="font-size:1.5rem;color:var(--main-color);background:#fbe9e7;border-radius:50%;width:38px;height:38px;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;">
            <i class="fas fa-bell"></i>
          </div>
          <div class="header-avatar" style="width:44px;height:44px;border-radius:50%;background:#fffbe6;display:flex;align-items:center;justify-content:center;font-size:1.3rem;color:var(--main-color);border:2px solid #fbe9e7;">
            <i class="fas fa-user-cog"></i>
          </div>
        </div>
      </div>
      <div class="dashboard-section" id="adminMainContent" style="max-width:1200px;margin:32px auto 0 auto;padding:0 24px;">
        <!-- Dynamic content will be rendered here -->
      </div>
    </div>
  </div>

  <script>
    // Demo data
    let stats = {
      users: 245,
      tutors: 58,
      learners: 187,
      lessons: 1247,
      active: 142,
      pendingApprovals: 12,
      revenue: 185000,
      systemHealth: 98
    };

    let activityData = {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
      users: [180, 195, 210, 225, 240, 245],
      lessons: [800, 920, 1050, 1150, 1200, 1247],
      revenue: [120, 135, 150, 165, 175, 185]
    };

    let logs = [
      { id: 1, type: 'error', user: 'student@vlu.edu.vn', time: '2024-06-01 10:00', message: 'Failed login attempt' },
      { id: 2, type: 'warn', user: 'tutor@vlu.edu.vn', time: '2024-06-01 10:05', message: 'Slow query detected' },
      { id: 3, type: 'info', user: 'admin@vlu.edu.vn', time: '2024-06-01 10:10', message: 'User created' },
      { id: 4, type: 'error', user: 'student2@vlu.edu.vn', time: '2024-06-02 09:00', message: 'Payment failed' },
      { id: 5, type: 'warn', user: 'tutor2@vlu.edu.vn', time: '2024-06-02 09:05', message: 'High CPU usage' },
      { id: 6, type: 'info', user: 'admin@vlu.edu.vn', time: '2024-06-02 09:10', message: 'Lesson approved' },
      { id: 7, type: 'error', user: 'student3@vlu.edu.vn', time: '2024-06-03 08:00', message: 'Session timeout' },
      { id: 8, type: 'warn', user: 'tutor3@vlu.edu.vn', time: '2024-06-03 08:05', message: 'Memory usage warning' },
      { id: 9, type: 'info', user: 'admin@vlu.edu.vn', time: '2024-06-03 08:10', message: 'Backup completed' }
    ];

    let users = [
      { id: 1, name: 'Nguyen Van A', email: 'nguyenvana@vlu.edu.vn', role: 'Student', status: 'Active', joinDate: '2024-01-15' },
      { id: 2, name: 'Le Thi B', email: 'lethib@vlu.edu.vn', role: 'Tutor', status: 'Active', joinDate: '2024-02-10' },
      { id: 3, name: 'Tran Van C', email: 'tranvanc@vlu.edu.vn', role: 'Student', status: 'Pending', joinDate: '2024-06-01' },
      { id: 4, name: 'Pham Thi D', email: 'phamthid@vlu.edu.vn', role: 'Tutor', status: 'Suspended', joinDate: '2024-03-20' }
    ];

    // Sidebar navigation
    const menuLinks = document.querySelectorAll('.sidebar-menu a');
    menuLinks.forEach(link => {
      link.onclick = function(e) {
        e.preventDefault();
        menuLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        
        const href = link.getAttribute('href');
        switch(href) {
          case '#dashboard':
            renderDashboard();
            break;
          case '#users':
            renderUsers();
            break;
          case '#monitor':
            renderMonitor();
            break;
          case '#settings':
            renderSettings();
            break;
          case '#logout':
            window.location.href = 'login.html';
            break;
        }
      };
    });

    function renderDashboard() {
      const content = `
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-users"></i></div>
            <div class="stat-info">
              <div class="stat-value">
                ${stats.users}
              </div>
              <div class="stat-label">Total Users</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-chalkboard-teacher"></i></div>
            <div class="stat-info">
              <div class="stat-value">${stats.tutors}</div>
              <div class="stat-label">Tutors</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-user-graduate"></i></div>
            <div class="stat-info">
              <div class="stat-value">${stats.learners}</div>
              <div class="stat-label">Students</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-book-open"></i></div>
            <div class="stat-info">
              <div class="stat-value">${stats.lessons}</div>
              <div class="stat-label">Total Lessons</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-user-clock"></i></div>
            <div class="stat-info">
              <div class="stat-value">${stats.active}</div>
              <div class="stat-label">Active Sessions</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-hourglass-half"></i></div>
            <div class="stat-info">
              <div class="stat-value">${stats.pendingApprovals}</div>
              <div class="stat-label">Pending Approvals</div>
            </div>
          </div>
          <div class="stat-card">
            <div class="stat-icon"><i class="fas fa-heartbeat"></i></div>
            <div class="stat-info">
              <div class="stat-value">${stats.systemHealth}%</div>
              <div class="stat-label">System Health</div>
            </div>
          </div>
        </div>

        <div style="display: flex; gap: 32px; flex-wrap: wrap;">
          <div class="chart-section" style="flex: 2; min-width: 400px;">
            <div class="section-title">System Performance</div>
            <div class="filter-group">
              <label>View by:</label>
              <select id="statType">
                <option value="users">Users</option>
                <option value="lessons">Lessons</option>
                <option value="revenue">Revenue (K)</option>
              </select>
              <label>Time:</label>
              <select id="statTime">
                <option value="6">Last 6 months</option>
                <option value="12">Last 12 months</option>
              </select>
            </div>
            <canvas id="statChart" height="80"></canvas>
          </div>

          <div class="upcoming-section" style="flex: 1; min-width: 300px;">
            <div class="section-title">Recent System Activity</div>
            <div style="display: flex; flex-direction: column; gap: 12px;">
              ${logs.slice(0, 6).map(log => `
                <div style="background: #f9f9f9; border-radius: 8px; padding: 12px; border-left: 4px solid ${getLogColor(log.type)};">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <i class="fas fa-${getLogIcon(log.type)}" style="color: ${getLogColor(log.type)};"></i>
                    <span style="font-weight: 500; font-size: 0.9rem; color: #666;">${log.time}</span>
                  </div>
                  <div style="font-size: 0.95rem;">${log.message}</div>
                  <div style="font-size: 0.85rem; color: #888; margin-top: 2px;">${log.user}</div>
                </div>
              `).join('')}
            </div>
          </div>
        </div>
      `;
      document.getElementById('adminMainContent').innerHTML = content;
      
      // Render chart
      setTimeout(() => {
        renderChart();
        document.getElementById('statType').onchange = renderChart;
        document.getElementById('statTime').onchange = renderChart;
      }, 100);
    }

    function renderChart() {
      const statType = document.getElementById('statType').value;
      const ctx = document.getElementById('statChart').getContext('2d');
      
      let data, label, color;
      switch(statType) {
        case 'users':
          data = activityData.users;
          label = 'Users';
          color = '#b11f24';
          break;
        case 'lessons':
          data = activityData.lessons;
          label = 'Lessons';
          color = '#d32f2f';
          break;
        case 'revenue':
          data = activityData.revenue;
          label = 'Revenue (K)';
          color = '#f44336';
          break;
      }
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: activityData.labels,
          datasets: [{
            label: label,
            data: data,
            backgroundColor: color,
            borderRadius: 6,
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true, ticks: { stepSize: statType === 'revenue' ? 20 : 50 } } }
        }
      });
    }

    function renderUsers() {
      const content = `
        <div class="section-title">User Management</div>
        
        <div class="filter-group">
          <select id="userRole">
            <option value="">All Roles</option>
            <option value="Student">Students</option>
            <option value="Tutor">Tutors</option>
          </select>
          <select id="userStatus">
            <option value="">All Status</option>
            <option value="Active">Active</option>
            <option value="Pending">Pending</option>
            <option value="Suspended">Suspended</option>
          </select>
          <input type="text" id="userSearch" placeholder="Search by name or email...">
          <button class="btn btn-primary" onclick="filterUsers()">Filter</button>
        </div>

        <div class="chart-section">
          <table class="data-table" id="usersTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Role</th>
                <th>Status</th>
                <th>Join Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="usersTableBody">
              ${renderUsersTable(users)}
            </tbody>
          </table>
        </div>
      `;
      document.getElementById('adminMainContent').innerHTML = content;
    }

    function renderUsersTable(userList) {
      return userList.map(user => `
        <tr>
          <td>${user.name}</td>
          <td>${user.email}</td>
          <td>${user.role}</td>
          <td>
            <span class="btn ${getStatusClass(user.status)}" style="font-size: 0.8rem; padding: 4px 8px;">
              ${user.status}
            </span>
          </td>
          <td>${user.joinDate}</td>
          <td>
            <button class="btn btn-primary" style="font-size: 0.8rem; padding: 4px 8px; margin-right: 4px;" onclick="editUser(${user.id})">Edit</button>
            <button class="btn ${user.status === 'Suspended' ? 'btn-success' : 'btn-danger'}" style="font-size: 0.8rem; padding: 4px 8px;" onclick="toggleUserStatus(${user.id})">
              ${user.status === 'Suspended' ? 'Activate' : 'Suspend'}
            </button>
          </td>
        </tr>
      `).join('');
    }

    function renderMonitor() {
      const content = `
        <div class="section-title">System Monitoring</div>
        
        <div class="filter-group">
          <select id="logType">
            <option value="">All Types</option>
            <option value="error">Error</option>
            <option value="warn">Warning</option>
            <option value="info">Info</option>
          </select>
          <input type="text" id="logUser" placeholder="Filter by user email...">
          <input type="date" id="logDate">
          <button class="btn btn-primary" onclick="filterLogs()">Filter</button>
          <button class="btn btn-secondary" onclick="exportLogs()">Export Logs</button>
        </div>

        <div class="chart-section">
          <table class="data-table">
            <thead>
              <tr>
                <th>Time</th>
                <th>User</th>
                <th>Type</th>
                <th>Message</th>
              </tr>
            </thead>
            <tbody id="logTableBody">
              ${renderLogTable(logs)}
            </tbody>
          </table>
        </div>
      `;
      document.getElementById('adminMainContent').innerHTML = content;
    }

    function renderLogTable(logList) {
      return logList.length ? logList.map(log => `
        <tr>
          <td>${log.time}</td>
          <td>${log.user}</td>
          <td>
            <span style="color: ${getLogColor(log.type)}; font-weight: 600;">
              ${log.type.toUpperCase()}
            </span>
          </td>
          <td>${log.message}</td>
        </tr>
      `).join('') : '<tr><td colspan="4" style="color: #bbb; text-align: center; padding: 12px;">No logs found.</td></tr>';
    }

    function renderSettings() {
      const content = `
        <div class="section-title">System Settings</div>
        
        <div style="display: flex; flex-direction: column; gap: 24px;">
          <div class="chart-section">
            <h3>General Settings</h3>
            <div class="form-group">
              <label>System Name</label>
              <input type="text" value="VLU Tutor System">
            </div>
            <div class="form-group">
              <label>Max Users</label>
              <input type="number" value="1000">
            </div>
            <div class="form-group">
              <label>Session Timeout (minutes)</label>
              <input type="number" value="60">
            </div>
            <button class="btn btn-primary">Save General Settings</button>
          </div>
          
          <div class="chart-section">
            <h3>Email Settings</h3>
            <div class="form-group">
              <label>SMTP Server</label>
              <input type="text" value="smtp.vlu.edu.vn">
            </div>
            <div class="form-group">
              <label>SMTP Port</label>
              <input type="number" value="587">
            </div>
            <div style="display: flex; flex-direction: column; gap: 12px;">
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" checked> Enable email notifications
              </label>
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" checked> Send welcome emails
              </label>
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox"> Send daily reports
              </label>
            </div>
            <button class="btn btn-primary">Save Email Settings</button>
          </div>

          <div class="chart-section">
            <h3>Security Settings</h3>
            <div class="form-group">
              <label>Password Min Length</label>
              <input type="number" value="8">
            </div>
            <div class="form-group">
              <label>Max Login Attempts</label>
              <input type="number" value="5">
            </div>
            <div style="display: flex; flex-direction: column; gap: 12px;">
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" checked> Require strong passwords
              </label>
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" checked> Enable two-factor authentication
              </label>
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox"> Force password change every 90 days
              </label>
            </div>
            <button class="btn btn-primary">Save Security Settings</button>
          </div>
        </div>
      `;
      document.getElementById('adminMainContent').innerHTML = content;
    }

    // Helper functions
    function getLogColor(type) {
      const colors = { error: '#f44336', warn: '#ff9800', info: '#2196f3' };
      return colors[type] || '#666';
    }

    function getLogIcon(type) {
      const icons = { error: 'exclamation-triangle', warn: 'exclamation-circle', info: 'info-circle' };
      return icons[type] || 'circle';
    }

    function getStatusClass(status) {
      const classes = { Active: 'btn-success', Pending: 'btn-warning', Suspended: 'btn-danger' };
      return classes[status] || 'btn-secondary';
    }

    function filterUsers() {
      const role = document.getElementById('userRole').value;
      const status = document.getElementById('userStatus').value;
      const search = document.getElementById('userSearch').value.toLowerCase();
      
      let filtered = users.filter(user => {
        return (!role || user.role === role) &&
               (!status || user.status === status) &&
               (!search || user.name.toLowerCase().includes(search) || user.email.toLowerCase().includes(search));
      });
      
      document.getElementById('usersTableBody').innerHTML = renderUsersTable(filtered);
    }

    function filterLogs() {
      const type = document.getElementById('logType').value;
      const user = document.getElementById('logUser').value.toLowerCase();
      const date = document.getElementById('logDate').value;
      
      let filtered = logs.filter(log => {
        return (!type || log.type === type) &&
               (!user || log.user.toLowerCase().includes(user)) &&
               (!date || log.time.startsWith(date));
      });
      
      document.getElementById('logTableBody').innerHTML = renderLogTable(filtered);
    }

    function editUser(userId) {
      const user = users.find(u => u.id === userId);
      if (user) {
        alert(`Edit user: ${user.name}\nThis would open an edit modal.`);
      }
    }

    function toggleUserStatus(userId) {
      const user = users.find(u => u.id === userId);
      if (user) {
        user.status = user.status === 'Suspended' ? 'Active' : 'Suspended';
        renderUsers();
      }
    }

    function exportLogs() {
      alert('Logs exported successfully!\nThis would download a CSV file.');
    }

    // Initialize dashboard
    window.addEventListener('DOMContentLoaded', function() {
      renderDashboard();
    });
  </script>
</body>
</html> 